<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- File generated by Telosys Tools Generator ( version 2.1.1 ) - Date 2015-04-29 ( Time 14:15:53 ) -->

<div class="wrap">
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c"    uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="s"    uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="fn"   uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt"  uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib tagdir="/WEB-INF/tags/util" prefix="util"%>
<%@ taglib tagdir="/WEB-INF/tags/input" prefix="input"%>

	<div class="container">
		<ul class="list-group">
		  <li class="list-group-item" style="background-color:#f5f5f5;">${posting.title} </li>
		  <li class="list-group-item" style="background-color:#f5f5f5;"><s:message code="board.writer"/>: ${posting.users.name}, <s:message code="board.createDate"/>: <fmt:formatDate value="${posting.createdAt}" pattern="yyyy-MM-dd"/></li>
		  <li class="list-group-item" style="min-height: 300px;">${posting.body}</li>
		  <c:forEach items="${uploadFiles}" var="List" varStatus="listCount">
		  	<li class="list-group-item" style="background-color:#f5f5f5;"><a href="${url}/uploadFiles/${List.id}">${List.extra1}</a> </li>
		  </c:forEach>
		</ul>
		
		<div class="btn-container">
			<c:if test="${bType != 10}">
				<c:if test="${posting.parentId == posting.id}">
					<a class="btn btn-default" href="${url}/reply/${posting.id}?type=${posting.postingTypes.id}" onclick="return isLogin();"><s:message code="reply"/></a>
				</c:if>
				<c:if test="${posting.users.id == id}">
					<a class="btn btn-default" href="${url}/modify/${posting.id}" ><s:message code="modify"/></a>
					<a class="btn btn-default" href="${url}/delete/${posting.id}?bType=${bType}" onclick="return delchk();"><s:message code="delete"/></a>
				</c:if>
			</c:if>
			<a class="btn btn-default" href="${url}?bType=${bType}" ><s:message code="list"/></a>
		</div>
		
		

		<div class="panel panel-default">
			<div class="panel-heading"><s:message code="comment"/></div>
			<div class="panel-body">
			<form:form class="form-horizontal" action="${url}/comment/create" modelAttribute="comment" 
									method="POST" id="write-form" onsubmit="return submitContents()">
				<form:input type="hidden" path="typeId"/>
				<form:input type="hidden" path="parentId"/>
				<form:textarea path="body" id="body" style="width: 100%; height: 80px;margin-bottom:20px;border-color: #ddd;" />	
				<button class="btn btn-default" type="submit" style="float:right" onclick="return isLogin();"><s:message code="enrolment"/></button>
			</form:form>
			
			</div>
		</div>
		<c:forEach items="${comments}" var="List" varStatus="listCount">
			<div class="panel panel-default">
				<div class="panel-heading">${List.users.name} | <fmt:formatDate value="${List.createdAt}" pattern="yyyy-MM-dd"/></div>
				<div class="panel-body row">
					<div class="col-xs-10">
						${List.body}
					</div>
					<c:if test="${List.users.id == id}">
						<div class="col-xs-2" style="text-align:right;">
							<a class="btn btn-default" href="${url}/delete/${List.id}?parentId=${List.parentId}" onclick="return delchk();"><s:message code="delete"/></a>
						</div>
					</c:if>
				</div>
			</div>
		</c:forEach>
	</div>	
</div>
<script type="text/javascript">
	function submitContents() {
		if (!isEmpty()) {
			return true;
		}else{
			return false;
		}
	}
	function isEmpty() {
		var result = false;
		var body = document.getElementById("body").value;
		if (stringIsEmpty(body)) {
			alert("내용을 입력해 주세요.");
			result = true;
		}
		
		return result;
	}
	function stringIsEmpty(str) {
		var blank_pattern = /^\s+|\s+$/g;

		if (str == '' || str == null) {
			return true;
		} else if (str.replace(blank_pattern, '') == "") {
			return true;
		}

		return false;
	}
	function delchk(){
		if(confirm("삭제 하시겠습니까?")){
			return true;
		}else{
			return false;
		}
	}
	function isLogin(){
		
		if("${member}"== "true"){
			return true;
		}else{
			alert("글쓰기는 로그인 후에 사용 가능합니다.");
			return false;
		}
	}
</script>
